<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <title>后台管理</title>
    <link rel="stylesheet" href="./css/layui.css">  
    <link rel="stylesheet" href="./css/common.css">  
    <script type="text/javascript" src="./js/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="./layui/layui/dist/layui.all.js"></script>
    <script type="text/javascript" src="./layui/layui/dist/lay/modules/element.js"></script>
    <script type="text/javascript" src="./js/common.js"></script>
    <script type="text/javascript" src="./js/axios.js"></script>
</head>
<body>
   <iframe id="frame-content" MARGINWIDTH=0 MARGINHEIGHT=0 HSPACE=0 VSPACE=0 FRAMEBORDER=0 SCROLLING=no src="./layout.html" width="100%"  height="900px"></iframe> 
    <div class="main" id="main">
        <div>
          <div class="layui-tab layui-tab-card" >
            <ul class="layui-tab-title">
              <li class="layui-this">用戶管理</li>
              <li>書籍管理</li>
               <li>分类管理</li>
            </ul>
            <!--用戶管理-->
            <div class="layui-tab-content" id="tabContent">
              <div class="layui-tab-item layui-show" id="userManager">
                <button type="button" class="layui-btn float-right mb-1" onclick="addUser()">新增用戶</button>
                <table class="layui-table">
                  <colgroup>
                    <col width="150">
                    <col width="200">
                    <col>
                  </colgroup>
                  <thead>
                    <tr id="uThId">
                    </tr> 
                  </thead>
                  <tbody id="uTBodyId">
                  </tbody>
                </table>
                  <div id="userPage"></div>

              </div>
            <!--用戶管理 end-->
            <!--書籍管理-->
              <div class="layui-tab-item" id="bookManager">
                <button type="button" class="layui-btn float-right mb-1" onclick="uploadBook()">上传书籍</button>
                  <!-- <button type="button" class="layui-btn float-right mb-1 mr-1" onclick="uploadChapter">新增章节</button> -->
                  <table class="layui-table">
                      <colgroup>
                        <col width="150">
                        <col width="200">
                        <col>
                      </colgroup>
                      <thead>
                        <tr id="thId">
                        </tr>
                      </thead>
                      <tbody id="tBodyId">
                      </tbody>
                    </table>
                  <div id="tablePage"></div>
              </div>
            <!--書籍管理 end-->
                <!--分类管理-->
                <div class="layui-tab-item" id="typeManager">
                    <button type="button" class="layui-btn mb-1 float-right" onclick="addType()">新增分类</button>
                    <table class="layui-table">
                        <colgroup>
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>
                        <thead>
                        <tr id="typeThId">
                        </tr>
                        </thead>
                        <tbody id="typeBodyId">
                        </tbody>
                    </table>
                    <div id="typePage"></div>
                </div>
                <!--書籍管理 end-->
                <div id="typeHtml"></div>
            </div>
          </div>
      </div>
    </div>
      </body>
<script>
    var ip = initIP();
      $(function() {
        init();
      });
      function init(){
        returnZindex();
        initTab();
        initTable();
      }
        //拼接Book   由於時間控件的問題，這裡必須用拼接組裝js，否則會出现laydate闪现等bug
      function pjBook(){
        var nHtml='<div class="layui-form-item" style="display: none">'
        nHtml+= '<label class="layui-form-label">id</label>'
        nHtml+='<div class="layui-input-block">'
        nHtml+='<input type="text" name="id" id="id" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">书籍名称</label>'
        nHtml+='<div class="layui-input-block">'
        nHtml+='<input type="text" name="name" id="name" lay-verify="name" placeholder="请输入书籍名称" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">作者</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="author" id="author" lay-verify="author" placeholder="请输入作者" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'
       
        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">出版社</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="publishingHouse" id="publishingHouse" lay-verify="publishingHouse" placeholder="请输入出版社" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">简介</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="synopsis" id="synopsis" lay-verify="synopsis" placeholder="请输入简介" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">字数</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="numberWorders" id="numberWorders" placeholder="请输入字数" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">封面</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="cover" id="cover" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">书籍状态</label>'
        nHtml+='<div class="layui-input-inline">'
        nHtml+='<input type="text" name="status" id="status" autocomplete="off" class="layui-input">'
        nHtml+='</div>'
        nHtml+='</div>'

        nHtml+='<div class="layui-form-item">'
        nHtml+= '<label class="layui-form-label">出版时间</label>'
        nHtml+='<div class="layui-input-block">'
        nHtml+=' <input type="text" class="layui-input" name="publicationTime" id="publicationTime" placeholder="yyyy-MM-dd HH:mm:ss">'
        nHtml+='</div>'

        return nHtml;
      }
      function pjUser() {
          var nHtml = '<div class="layui-form-item" style="display: none">'
          nHtml+='<label class="layui-form-label">id</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+=' <input type="text" name="id" id="id" autocomplete="off" class="layui-input">'
          nHtml+=' </div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">用戶名</label>'
          nHtml+='<div class="layui-input-block">'
          nHtml+='<input type="text" name="username" id="username"  placeholder="请输入用戶名" autocomplete="off" class="layui-input">'
          nHtml+='</div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">密码</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+=' <input type="password" name="password" id="password" placeholder="请输入密码" autocomplete="off" class="layui-input">'
          nHtml+=' </div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">账号</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+='<input type="text" name="account" id="account"  placeholder="请输入账号" autocomplete="off" class="layui-input">'
          nHtml+='</div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">图片</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+='<input type="text" name="icon" id="icon" placeholder="请输入图片" autocomplete="off" class="layui-input">'
          nHtml+='</div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">身份证</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+='<input type="number" name="identity" id="identity" placeholder="请输入身份证" autocomplete="off" class="layui-input">'
          nHtml+='</div>'
          nHtml+='</div>'
          return nHtml;
      }
      function pjType() {
          var nHtml = '<div class="layui-form-item" style="display: none">'
          nHtml+='<label class="layui-form-label">id</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+=' <input type="text" name="id" id="id" autocomplete="off" class="layui-input">'
          nHtml+=' </div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">类型</label>'
          nHtml+='<div class="layui-input-block">'
          nHtml+='<input type="text" name="typeName" id="typeName" lay-verify="typeName" placeholder="请输入类型名称" autocomplete="off" class="layui-input">'
          nHtml+='</div>'
          nHtml+='</div>'


          return nHtml;
      }
      function initTable(){
          let params = {
              page:1,
              pageSize:10
          }
          initBookTable(params);
          initUserTable(params);
          initTypeTable(params)


      }

      function getTablePageParam(curr,limit) {
         console.log("接收到的分页",curr,limit)
         if(curr&&limit){
             let params={
                 pageSize:limit,
                 page:curr
             }
             initBookTable(params)
         }else{
             return false;
         }
     }
      function getUserPageParam(curr,limit) {
        console.log("接收到的分页",curr,limit)
        if(curr&&limit){
            let params={
                pageSize:limit,
                page:curr
            }
            initUserTable(params)
        }else{
            return false;
        }
    }
      function getTypeParam(curr,limit) {
          if(curr&&limit){
              let params={
                  pageSize:limit,
                  page:curr
              }
              initTypeTable(params)
          }else{
              return false;
          }
      }
      function initTypeTable(params) {
          let getType={
              url:ip+"type",
              method:"GET",
              params:params
          }
          axios(getType).then(data=>{
              console.log("table",data)
              console.log("书籍数据",data.data.data.records);
          initPage("typePage",getTypeParam,data.data.data.total,params.page);
          var typeJson=data.data.data.records;
          var typeTitle = [
              {name:'id',key:'id'},
              {name:'分类名称',key:'typeName'},
          ]
          if(typeJson){
              var keys = Object.keys(typeJson[0]);
              console.log(keys)
          }
          let thHtml="";
          let tBodyHtml ="";
          for(let title of typeTitle){
             thHtml+='<th>'+title.name+'</th>'
          }
          thHtml+='<th>操作</th>'
          $("#typeThId").html(thHtml);
          for(let item of typeJson){
              tBodyHtml+='<tr>'
              for(let title of typeTitle){
                 tBodyHtml+='<td>'+item[title.key]+'</td>'
              }
              var $row = JSON.stringify(item).replace(/\"/g,"'");
              tBodyHtml+='<td><button type="button" class="layui-btn layui-btn-normal float-left mb-1" onclick="updateType('+$row+')" >修改</button>'
              tBodyHtml+='<button type="button" class="layui-btn layui-btn-danger  mb-1" onclick="deleteType('+$row+')">刪除</button></td>'
              tBodyHtml+='</tr>'
          }
          $("#typeBodyId").html(tBodyHtml)
      })
     }
      function initBookTable(params){
          let getBook={
              url:ip+"book",
              method:"GET",
              params:params
          }
          axios(getBook).then(data=>{
              console.log("table",data)
              console.log("书籍数据",data.data.data.records);
              initPage("tablePage",getTablePageParam,data.data.data.total,params.page);
              var bookJson=data.data.data.records;
          var bookTitle = [
              {name:'id',key:'id'},
              {name:'书籍名称',key:'name'},
              {name:'作者',key:'author'},
              {name:"出版社",key:'publishingHouse'},
              {name:"出版時間",key:'publicationTime'},
              {name:'简介',key:'synopsis'},
              {name:'字数',key:'numberWorders'},
              {name:'封面',key:'cover'},
              {name:'状态',key:'status'},
              {name:'创建时间',key:'createTime'},
          ]
          if(bookJson){
              var keys = Object.keys(bookJson[0]);
              console.log(keys)
          }
          let thHtml="";
          let tBodyHtml ="";
          for(let title of bookTitle){
              if(title.key=="id"){
                  thHtml+='<th class="small">'+title.name+'</th>'
              }
              else if(title.key=="name"){
                  thHtml+='<th class="middle">'+title.name+'</th>'
              }
              else{
                  thHtml+='<th>'+title.name+'</th>'
              }
          }
          thHtml+='<th style="width:400px">操作</th>'
          $("#thId").html(thHtml);
          for(let item of bookJson){
              tBodyHtml+='<tr>'
              for(let title of bookTitle){
                  if(title.key=="id"){
                      tBodyHtml+='<td class="small">'+item[title.key]+'</td>'
                  }
                  else if(title.key=="name"){
                      tBodyHtml+='<td class="middle">'+item[title.key]+'</td>'
                  }
                  else{
                      tBodyHtml+='<td>'+item[title.key]+'</td>'
                  }
              }
              var $row = JSON.stringify(item).replace(/\"/g,"'");
              tBodyHtml+='<td><button type="button" class="layui-btn layui-btn-normal float-left mb-1" onclick="updateBook('+$row+')" >修改</button>'
              tBodyHtml+='<button type="button" class="layui-btn mb-1" onclick="uploadChapter('+$row+')">新增章节</button>'
              tBodyHtml+='<button type="button" class="layui-btn mb-1" onclick="typeBook('+$row+')">分类</button>'
              tBodyHtml+='<button type="button" class="layui-btn layui-btn-danger  mb-1" onclick="deleteBook('+$row+')">刪除</button></td>'
              tBodyHtml+='</tr>'
          }
          $("#tBodyId").html(tBodyHtml)
          })
      }
      function initUserTable(params) {
          let getUser = {
              url:ip+"user",
              method:"GET",
              params:params
          }
          axios(getUser).then(data=>{
              console.log("用户数据",data)
              console.log("分页后数据",data.data.data.records);
              initPage("userPage",getUserPageParam,data.data.data.total,params.page);
              let usrtJson = data.data.data.records;
              //有数据才将表格显示出来
              if(usrtJson){
                  drawUser(usrtJson);
              }
          })


      }
      function drawUser(data) {
          let userJson = data
          if(userJson){
              var keys = Object.keys(userJson[0]);
              console.log(keys)
          }
          let userTitle = [
              {name:'id',key:'id'},
              {name:'用户名',key:'username'},
              {name:'密码',key:'password'},
              {name:'账号',key:'account'},
              {name:'图片',key:'icon'},
              {name:"身份",key:'identity'}
          ]
          let thHtml="";
          let tBodyHtml ="";
          for(let title of userTitle){
              thHtml+='<th>'+title.name+'</th>'
          }
          thHtml+='<th style="width:280px">操作</th>'
          $("#uThId").html(thHtml);
          for(let item of userJson){
              tBodyHtml+='<tr>'
              for(let key of Object.keys(item)){
                  tBodyHtml+='<td>'+item[key]+'</td>'
              }
              var $row = JSON.stringify(item).replace(/\"/g,"'");
              tBodyHtml+='<td><button type="button" class="layui-btn layui-btn-normal float-left mb-1" onclick="updateUser('+$row+')" >修改</button>'
              tBodyHtml+='<button type="button" class="layui-btn layui-btn-danger  mb-1" onclick="deleteUser('+$row+')">刪除</button></td>'
              tBodyHtml+='</tr>'
          }
          $("#uTBodyId").html(tBodyHtml)
      }
      function updateUser(row) {
          console.log(row)
          let html = pjUser();
          alertcomfirm2("updateUserLayer","修改用户",html,"updateUserVerify",null,validateAddUser,ajaxUpdateUser,row,getUserData)
      }
      function ajaxUpdateUser(form) {
          form.name = form.username;
          let updateUser={
              url:ip+"user/",
              method:"put",
              data:form
          }
          axios(updateUser).then(()=>{
              alertLayer("编辑用户","修改成功",closeForm);
      }).catch(err=>{alertLayer2("编辑用户",err)})
      }
      function deleteUser(rowList) {
          quesForm("你確定要刪除嗎？",deleteUserAjax,rowList)
      }
      function deleteUserAjax(form) {
        axios.delete(ip+"user/"+form.id).then(()=>{
            alertLayer("删除用户","删除成功",closeForm);
          }).catch(err=>{alertLayer2("删除用户",err)})
      }
      function uploadBook(){
        let rowList = {
          name: "",
          author: "",
          publishingHouse: "",
          synopsis: "",
          numberWorders:"",
          cover:"",
          status:""
        }
        let html = pjBook();
        alertcomfirm2("addBookLayer","添加书籍",html,"addBookVerify",'#publicationTime',validateAddBook,ajaxAddBook,rowList,getFormData)
      }
      function uploadChapter(){
        
      }
      function updateBook(rowList){
        let html = pjBook();
        alertcomfirm2("addBookLayer","修改书籍",html,"updateBookVerify",'#publicationTime',validateAddBook,ajaxUpdateBook,rowList,getFormData)
      }
      function getUserData(rowList) {
          document.getElementById("id").value=rowList.id;
          document.getElementById("username").value=rowList.name;
          document.getElementById("password").value=rowList.password;
          document.getElementById("account").value=rowList.account;
          document.getElementById("icon").value=rowList.icon;
          document.getElementById("identity").value=rowList.identity;

      }
      function getBookTypeData(rowList){
        document.getElementById("bookId").value=rowList.bookId;
        document.getElementById("typeId").value=rowList.typeId;
    }
      function getTypeData(rowList) {
          document.getElementById("id").value=rowList.id;
          document.getElementById("typeName").value=rowList.typeName;
      }
      //渲染後設置值獲取數據(修改的數據打開在這裡賦值)
      function getFormData(rowList){
        document.getElementById("id").value=rowList.id;
        document.getElementById("name").value=rowList.name;
        document.getElementById("author").value=rowList.author;
        document.getElementById("status").value=rowList.status;
        document.getElementById("publishingHouse").value=rowList.publishingHouse;
        document.getElementById("synopsis").value=rowList.synopsis;
        document.getElementById("numberWorders").value=rowList.numberWorders;
        document.getElementById("cover").value=rowList.cover;
        document.getElementById("publicationTime").value=rowList.publicationTime;
      }
      function deleteBook(rowList){
        console.log(rowList)
        quesForm("你確定要刪除嗎？",deleteBookAjax,rowList)
      }
      function typeBook(row) {
          //获取所有type
          let getType={
              url:ip+"type",
              method:"GET",
              params:{}
          }
         axios(getType).then(data=>{
              console.log("所有类型有"+data)
              console.log("所有类型有"+data.data.data.records)
              let typeJson = data.data.data.records;
          var nHtml = '<div class="layui-form-item" style="display: none">'
          nHtml+='<label class="layui-form-label">id</label>'
          nHtml+='<div class="layui-input-inline">'
          nHtml+=' <input type="text" name="bookId" id="bookId" autocomplete="off" class="layui-input">'
          nHtml+=' </div>'
          nHtml+='</div>'
          nHtml+='<div class="layui-form-item">'
          nHtml+='<label class="layui-form-label">书籍类别</label>'
          nHtml+='<div class="layui-input-block">'
          nHtml+='<select name="typeId" id="typeId" lay-verify="typeId">'
          nHtml+='<option value="">---请选择---</option>'
          for(let item of typeJson){
              nHtml+='<option value='+item.id+'>'+item.typeName+'</option>'
          }
          nHtml+='</select>'
          nHtml+='</div>'
          nHtml+='</div>'
          let rowList = {
              bookId:row.id,
              typeId:""
          }
          alertcomfirm2("addBookTypeLayer","添加书籍类型",nHtml,"addBookTypeVerify",null,validateBookType,ajaxAddBookType,rowList,getBookTypeData)
         })



      }
      function validateAddBook(form){
              var form = layui.form;
              form.verify({
                    lusername:function(value){
                      if(value.length==0){
                         return '用戶名不能爲空'
                       }
                    },
                    lpassword: function(value) {
                       if(value.length==0){
                         return '密碼不能爲空'
                    }
                  }
                });
      }

      function ajaxAddBook(data){
        console.log(data)
        //如果成功，將status寫入session
          let addBook={
            url:ip+"book",
            method:"POST",
            data:data
          }
          axios(addBook).then(res=>{
              alertLayer("编辑书籍","新增成功",closeForm);
          }).catch(err=>{alertLayer2("编辑书籍",err);})
      }
      function  addUser() {
          let rowList = {
              name: "",
              password:"",
              account:"",
              icon:"",
              identity:""
          }
          let html = pjUser();
          alertcomfirm2("addUserLayer","添加用户",html,"addUserVerify",null,validateAddUser,ajaxAddUser,rowList,getUserData)
      }
      function addType() {
          let rowList={
              id:"",
              typeName:""
          }
          let html = pjType();
          alertcomfirm2("addTypeLayer","添加类型",html,"addTypeVerify",null,validateAddType,ajaxAddType,rowList,getTypeData)
      }
      function updateType(row) {
          console.log(row)
          let html = pjType();
          alertcomfirm2("updateTypeLayer","修改类型",html,"updateUserVerify",null,validateAddUser,ajaxUpdateType,row,getTypeData)

      }
      function deleteType(row) {
          console.log(row)
          quesForm("你確定要刪除嗎？",deleteTypeAjax,row)
      }
      function deleteTypeAjax(form) {
          axios.delete(ip+"type/"+form.id).then(()=>{
              alertLayer("删除类型","删除成功",closeForm);
      }).catch(err=>{alertLayer2("删除类型",err)})
      }
    function validateAddUser(form) {
            var form = layui.form;
            form.verify({
                identity:function (value) {
                    if(typeof value !== "number"){
                        return "身份必须是数字"
                    }
                }
            });
    }
    function validateBookType(form) {
        var form = layui.form;
        form.verify({
            typeId:function (value) {
                if(!value){
                    return "参数不能为空"
                }
            }
        });
    }
    function validateAddType(form) {
        var form = layui.form;
        form.verify({
            typeName:function (value) {
                if(!value){
                    return "参数不能为空"
                }
            }
        });
    }
    function ajaxAddBookType(form) {
        // validateBookType(form)
          console.log(form)
        if(form.typeId&&form.bookId){
            let addBookType = {
                url:ip+"book-type/",
                method:"POST",
                data:form
            }
            axios(addBookType).then(()=>{
                alertLayer("编辑书籍类型","编辑成功",closeForm);
        }).catch(err=>{alertLayer2("编辑用户",err)})
        }
    }
      function ajaxAddUser(form) {
          console.log(form)
          let addUser = {
              url:ip+"user/register",
              method:"POST",
              data:form
          }
          axios(addUser).then(()=>{
              alertLayer("编辑用户","新增成功",closeForm);
          }).catch(err=>{alertLayer2("编辑用户",err)})
      }
      function ajaxAddType(form) {
          console.log(form)
          let addUser = {
              url:ip+"type",
              method:"POST",
              data:form
          }
          axios(addUser).then(()=>{
              alertLayer("新增类型","新增成功",closeForm);
      }).catch(err=>{alertLayer2("新增类型",err)})
      }
      function ajaxUpdateType(form) {
          let addUser = {
              url:ip+"type",
              method:"PUT",
              data:form
          }
          axios(addUser).then(()=>{
              alertLayer("修改类型","修改成功",closeForm);
      }).catch(err=>{alertLayer2("修改类型",err)})
      }
      function closeForm() {
          layer.closeAll();
          init();
      }
      function deleteBookAjax(form){
          axios.delete(ip+"book/"+form.id).then(()=>{
              alertLayer("删除书籍","删除成功",closeForm);
          }).catch(err=>{alertLayer2("删除书籍",err)})
      }
      function ajaxUpdateBook(formData){
          let updateBook={
              url:ip+"book/",
              method:"PUT",
              data:formData
          }
          axios(updateBook).then(()=>{
              alertLayer("修改书籍","修改成功",closeForm);
          }).catch(err=>alertLayer2("修改书籍",err))
      }
      function initTab(){
        
      }
      function returnZindex(){
        let dom = document.getElementById("main")
        dom.style.zIndex = 0;
      }
      function changeZindex(){
        let dom = document.getElementById("main")
        dom.style.zIndex = -1;
      }
      function returnZindex(){
        let dom = document.getElementById("main")
        dom.style.zIndex = 0;
      }
    
      var openFile = function(event) {
            var input = event.target;
            console.log(event)
            var reader = new FileReader();
            reader.onload = function() {
                if(reader.result) {
                    //显示文件内容
                    $("#output").html(reader.result);
                }
            };
            reader.readAsText(input.files[0]);
        };
        function mouseup(){
          // console.log("mouseup")
          let w = window.getSelection();
        }
     
   
     
    
</script>
<style>
    .main{
      position:absolute;
      top: 60px;
      width: 96%;
      margin-left: 2%;
      height: 80%;
      z-index: -1;

    }
    .main2{
      top: 80px;
      position:absolute;
      border: 1px solid #dde0e4;
      overflow-y: auto;
      overflow-x: hidden;
    }
    .layui-upload-img{
      width:92px;
      height: 92px;
      margin: 0 10px 10px 0;
    }
    .small{
        /*width: 10px !important;*/
        width: 2%;
    }
    .middle{
        width:10%
    }
    .layui-table th, .layui-table td{
        padding: 2px 2px !important;
    }
    .layui-form-select{
        width: 190px !important;
    }
</style>
</html>